<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>NA • fplscrapR</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script>



<meta property="og:title" content="NA" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-title-body">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">fplscrapR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="articles/afdr.html">Creating an Alternative FDR' (aFDR) ranking of opponents by FPL points allowed</a>
    </li>
    <li>
      <a href="articles/afdrtable.html">Creating an 'Alternative FDR' (aFDR) fixture table</a>
    </li>
    <li>
      <a href="articles/allvignettes.html">allvignettes</a>
    </li>
    <li>
      <a href="articles/aubatransfers.html">Aubameyang ownership and net transfers for the first 25 gameweeks</a>
    </li>
    <li>
      <a href="articles/avgfplplayercost.html">Most expensive teams by average FPL player cost</a>
    </li>
    <li>
      <a href="articles/bpsforgame.html">Comparing total team BPS scores for a given game</a>
    </li>
    <li>
      <a href="articles/entryscores.html">Average and top entry scores for the first 25 gameweeks</a>
    </li>
    <li>
      <a href="articles/fdrtable.html">Creating your own 'FDR' fixture table</a>
    </li>
    <li>
      <a href="articles/findgoalscorers.html">Finding the names of goalscorers in a given fixture</a>
    </li>
    <li>
      <a href="articles/fixtable.html">Creating a simple fixture table</a>
    </li>
    <li>
      <a href="articles/hazalexishist.html">Comparing historical FPL total season scores for Eden Hazard and Alexis Sanchez</a>
    </li>
    <li>
      <a href="articles/listmyleagues.html">List your classic mini-leagues and current ranks</a>
    </li>
    <li>
      <a href="articles/mlmostowned.html">Finding the most owned players amongst the top 20 teams of your favourite mini-league</a>
    </li>
    <li>
      <a href="articles/mltop.html">Listing the top 20 of your favourite mini-league</a>
    </li>
    <li>
      <a href="articles/salahpoints.html">Mohamed Salah's points in each gameweek for the first 25 gameweeks</a>
    </li>
    <li>
      <a href="articles/simplexamodel.html">Building a very simple expected assists (xA) model</a>
    </li>
    <li>
      <a href="articles/topperformers.html">List of top performers by FPL goals and assists</a>
    </li>
    <li>
      <a href="articles/vizentryhist.html">Visualizing the FPL histories of entries</a>
    </li>
    <li>
      <a href="articles/vizrankprogress.html">Visualizing your in-season Overall Rank progress</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/wiscostret/fplscrapR">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="contents col-md-9">
    <div class="page-header">
      <h1>NA</h1>
    </div>


<div id="most-expensive-teams-by-average-fpl-player-cost" class="section level2">
<h2 class="hasAnchor">
<a href="#most-expensive-teams-by-average-fpl-player-cost" class="anchor"></a>Most expensive teams by average FPL player cost</h2>
<p>Suppose we are interested in comparing which Premier League teams have the most expensive FPL players on average?</p>
<p>First we fetch the full summary data on all FPL players using the get_player_info function:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(fplscrapR)

df &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_player_info.html">get_player_info</a></span>()</code></pre></div>
<p>Next we use dplyr and ggplot2 to transform and plot the data, ranking each Premier League by its average FPL player cost:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)

df %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(id, team, now_cost) %&gt;%<span class="st"> </span><span class="co"># selecting the relevant columns</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">now_cost=</span>now_cost/<span class="dv">10</span>) %&gt;%<span class="st"> </span><span class="co"># transforming the cost to millions (for some reason the FPL data structures FPL cost as 100.000s)</span>
<span class="st">  </span><span class="kw">group_by</span>(team) %&gt;%<span class="st"> </span><span class="co"># transformation to group and mean-summarize the costs at the 'team' variable level </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(now_cost)) %&gt;%
<span class="st">    </span><span class="kw">ggplot</span>() +<span class="st"> </span><span class="co"># plotting using ggplot2</span>
<span class="st">    </span><span class="kw">geom_col</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/reorder.factor">reorder</a></span>(team,-<span class="st">`</span><span class="dt">mean(now_cost)</span><span class="st">`</span>),<span class="dt">y=</span><span class="st">`</span><span class="dt">mean(now_cost)</span><span class="st">`</span>),<span class="dt">fill=</span><span class="st">"blue"</span>) +
<span class="st">    </span><span class="kw">theme_bw</span>() +
<span class="st">    </span><span class="kw">scale_x_discrete</span>(
      <span class="dt">labels=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"1"</span>=<span class="st">"ARS"</span>,<span class="st">"2"</span>=<span class="st">"BOU"</span>,<span class="st">"3"</span>=<span class="st">"BHA"</span>,<span class="st">"4"</span>=<span class="st">"BUR"</span>,<span class="st">"5"</span>=<span class="st">"CAR"</span>,<span class="st">"6"</span>=<span class="st">"CHE"</span>,
        <span class="st">"7"</span>=<span class="st">"CRY"</span>,<span class="st">"8"</span>=<span class="st">"EVE"</span>,<span class="st">"9"</span>=<span class="st">"FUL"</span>,<span class="st">"10"</span>=<span class="st">"HUD"</span>,<span class="st">"11"</span>=<span class="st">"LEI"</span>,<span class="st">"12"</span>=<span class="st">"LIV"</span>,
        <span class="st">"13"</span>=<span class="st">"MCI"</span>,<span class="st">"14"</span>=<span class="st">"MUN"</span>,<span class="st">"15"</span>=<span class="st">"NEW"</span>,<span class="st">"16"</span>=<span class="st">"SOU"</span>,<span class="st">"17"</span>=<span class="st">"TOT"</span>,<span class="st">"18"</span>=<span class="st">"WAT"</span>,
        <span class="st">"19"</span>=<span class="st">"WHU"</span>,<span class="st">"20"</span>=<span class="st">"WOL"</span>)) +
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">"Team"</span>,<span class="dt">y=</span><span class="st">"Mean player cost (£m)"</span>,
      <span class="dt">title=</span><span class="st">"Mean FPL player cost for Premier League teams"</span>,
      <span class="dt">caption=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"Data from fplscrapR | "</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Sys.time">Sys.Date</a></span>(),<span class="dt">sep=</span><span class="st">""</span>))</code></pre></div>
<p><img src="C:%5CUsers%5Crcc.dbp%5CAppData%5CLocal%5CTemp%5CRtmpyIobnS%5Cpreview-22d47d5d10ce.dir%5Callvignettes_files/figure-markdown_strict/unnamed-chunk-3-1.png"></p>
<hr>
</div>
<div id="comparing-historical-fpl-total-season-scores-for-eden-hazard-and-alexis-sanchez" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-historical-fpl-total-season-scores-for-eden-hazard-and-alexis-sanchez" class="anchor"></a>Comparing historical FPL total season scores for Eden Hazard and Alexis Sanchez</h2>
<p>Suppose we are interested in how the FPL histories of Eden Hazard and Alexis Sanchez compare?</p>
<p>First we fetch the player histories of those two players using get_player_hist, mobilising their playerids using get_player_id:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(fplscrapR)

df &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_player_hist.html">get_player_hist</a></span>(<span class="dt">playerid=</span><span class="kw"><a href="reference/get_player_id.html">get_player_id</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Eden Hazard"</span>,<span class="st">"Alexis Sánchez"</span>))$id)</code></pre></div>
<p>Next we use dplyr and ggplot2 to transform and plot the data, showing the total FPL scores by season for the two players across their FPL careers:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)

df %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(playername,season_name,total_points) %&gt;%<span class="st"> </span><span class="co"># selecting the relevant columns</span>
<span class="st">  </span><span class="kw">ggplot</span>() +<span class="st"> </span><span class="co"># plotting using ggplot2</span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>season_name,<span class="dt">y=</span>total_points,<span class="dt">group=</span>playername,<span class="dt">colour=</span>playername),<span class="dt">size=</span><span class="dv">1</span>) +
<span class="st">    </span><span class="kw">theme_bw</span>() +
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">"Season"</span>,<span class="dt">y=</span><span class="st">"Total score"</span>,<span class="dt">title=</span><span class="st">"Historical FPL season scores by Hazard and Sanchez"</span>,<span class="dt">caption=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"Data from fplscrapR | "</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Sys.time">Sys.Date</a></span>(),<span class="dt">sep=</span><span class="st">""</span>))</code></pre></div>
<p><img src="C:%5CUsers%5Crcc.dbp%5CAppData%5CLocal%5CTemp%5CRtmpyIobnS%5Cpreview-22d47d5d10ce.dir%5Callvignettes_files/figure-markdown_strict/unnamed-chunk-6-1.png"></p>
<hr>
</div>
<div id="aubameyang-ownership-and-net-transfers-for-the-first-25-gameweeks" class="section level2">
<h2 class="hasAnchor">
<a href="#aubameyang-ownership-and-net-transfers-for-the-first-25-gameweeks" class="anchor"></a>Aubameyang ownership and net transfers for the first 25 gameweeks"</h2>
<p>Suppose we are interested in how the ownership of Pierre-Emerick Aubameyang has changed through transfers over the course of the first 25 gameweeks of the year?</p>
<p>First we fetch the gameweek-by-gameweek details of the player using get_player_details, mobilising the playerid using get_player_id:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(fplscrapR)

df &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_player_details.html">get_player_details</a></span>(<span class="kw"><a href="reference/get_player_id.html">get_player_id</a></span>(<span class="st">"Pierre-Emerick Aubameyang"</span>)$id)</code></pre></div>
<p>Next we use dplyr, tidyr and ggplot2 to transform and plot the data, showing the total number of owners and net transfers out for each gameweek:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyr)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)

df %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(round %in%<span class="st"> </span><span class="dv">1</span>:<span class="dv">25</span>) %&gt;%<span class="st"> </span><span class="co"># filtering for the GWs we are interested in</span>
<span class="st">  </span><span class="kw">select</span>(round,transfers_balance,selected) %&gt;%<span class="st"> </span><span class="co"># selecting the relevant columns</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="st">"var"</span>,<span class="st">"value"</span>,-round) %&gt;%<span class="st"> </span><span class="co"># transforming from wide to long format for ggplot</span>
<span class="st">  </span><span class="kw">ggplot</span>() +<span class="st"> </span><span class="co"># plotting using ggplot2</span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>round,<span class="dt">y=</span>value,<span class="dt">group=</span>var,<span class="dt">colour=</span>var),<span class="dt">size=</span><span class="dv">1</span>) +
<span class="st">    </span><span class="kw">theme_bw</span>() +
<span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="dv">1</span>:<span class="dv">25</span>) +
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">"Gameweek"</span>,<span class="dt">title=</span><span class="st">"Aubameyang ownership and net transfers"</span>,<span class="dt">caption=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"Data from fplscrapR | "</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Sys.time">Sys.Date</a></span>(),<span class="dt">sep=</span><span class="st">""</span>))</code></pre></div>
<p><img src="C:%5CUsers%5Crcc.dbp%5CAppData%5CLocal%5CTemp%5CRtmpyIobnS%5Cpreview-22d47d5d10ce.dir%5Callvignettes_files/figure-markdown_strict/unnamed-chunk-9-1.png"></p>
<hr>
</div>
<div id="mohamed-salahs-points-in-each-gameweek-for-the-first-25-gameweeks" class="section level2">
<h2 class="hasAnchor">
<a href="#mohamed-salahs-points-in-each-gameweek-for-the-first-25-gameweeks" class="anchor"></a>Mohamed Salah’s points in each gameweek for the first 25 gameweeks</h2>
<p>Suppose we are interested in the progression and variance of Mohamed Salah’s FPL score in each gameweek? Here, we take the first 25 gameweeks of the season as an example.</p>
<p>First we fetch the gameweek-by-gameweek details of the player using get_player_details, mobilising the playerid using get_player_id:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(fplscrapR)

df &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_player_details.html">get_player_details</a></span>(<span class="kw"><a href="reference/get_player_id.html">get_player_id</a></span>(<span class="st">"Mohamed Salah"</span>)$id)</code></pre></div>
<p>Next we use dplyr and ggplot2 to transform and plot the data, showing Salah’s round score for each gameweek:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)

df %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(round %in%<span class="st"> </span><span class="dv">1</span>:<span class="dv">25</span>) %&gt;%<span class="st"> </span><span class="co"># filtering for the GWs we are interested in</span>
<span class="st">  </span><span class="kw">select</span>(round,total_points) %&gt;%<span class="st"> </span><span class="co"># selecting the relevant columns</span>
<span class="st">  </span><span class="kw">ggplot</span>() +<span class="st"> </span><span class="co"># plotting with ggplot2</span>
<span class="st">    </span><span class="kw">geom_col</span>(<span class="kw">aes</span>(<span class="dt">x=</span>round,<span class="dt">y=</span>total_points),<span class="dt">fill=</span><span class="st">"red"</span>,<span class="dt">size=</span><span class="dv">1</span>) +
<span class="st">    </span><span class="kw">theme_bw</span>() +
<span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="dv">1</span>:<span class="dv">25</span>) +
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">"Gameweek"</span>,<span class="dt">y=</span><span class="st">"Round score"</span>,<span class="dt">title=</span><span class="st">"Salah's round score by gameweek"</span>,<span class="dt">caption=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"Data from fplscrapR | "</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Sys.time">Sys.Date</a></span>(),<span class="dt">sep=</span><span class="st">""</span>))</code></pre></div>
<p><img src="C:%5CUsers%5Crcc.dbp%5CAppData%5CLocal%5CTemp%5CRtmpyIobnS%5Cpreview-22d47d5d10ce.dir%5Callvignettes_files/figure-markdown_strict/unnamed-chunk-12-1.png"></p>
<hr>
</div>
<div id="list-of-top-performers-by-fpl-goals-and-assists" class="section level2">
<h2 class="hasAnchor">
<a href="#list-of-top-performers-by-fpl-goals-and-assists" class="anchor"></a>List of top performers by FPL goals and assists</h2>
<p>Suppose we are interested in listing the top FPL performers by FPL goals and assists? Again, we take the first 25 gameweeks of the season as an example.</p>
<p>First we fetch the gameweek-by-gameweek details of ALL players using get_player_details:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(fplscrapR)

df &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_player_details.html">get_player_details</a></span>() <span class="co"># this may take a while to load as it fetches ALL player details</span></code></pre></div>
<p>Next we use dplyr and ggplot2 to transform and plot the data, showing the top performers:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)

df %&gt;%
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(round %in%<span class="st"> </span><span class="dv">1</span>:<span class="dv">25</span>) %&gt;%<span class="st"> </span><span class="co"># filtering for the GWs we are interested in</span>
<span class="st">  </span><span class="kw">select</span>(playername,goals_scored,assists) %&gt;%<span class="st"> </span><span class="co"># selecting the relevant columns</span>
<span class="st">  </span><span class="kw">group_by</span>(playername) %&gt;%<span class="st"> </span><span class="co"># transformation to group and summarize the performance at the 'playername' variable level</span>
<span class="st">  </span><span class="kw">summarize_all</span>(sum) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="st">"involvements"</span>=goals_scored+assists) %&gt;%<span class="st"> </span><span class="co"># adding a new variable that sums the goals scored and assists</span>
<span class="st">  </span><span class="kw">arrange</span>(-involvements) %&gt;%<span class="st">  </span><span class="co"># ordering (arranging) the table by top involvements</span>
<span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span>:<span class="dv">20</span>) <span class="co"># showing the top20 only</span>

## # A tibble: 20 x 4
##    playername                goals_scored assists involvements
##    &lt;fct&gt;                            &lt;int&gt;   &lt;int&gt;        &lt;int&gt;
##  1 Mohamed Salah                       16       8           24
##  2 Eden Hazard                         12      10           22
##  3 Raheem Sterling                     10      12           22
##  4 Sergio Agüero                       14       8           22
##  5 Pierre-Emerick Aubameyang           15       6           21
##  6 Harry Kane                          14       6           20
##  7 Leroy Sané                           8      11           19
##  8 Callum Wilson                       10       8           18
##  9 Paul Pogba                           9       9           18
## 10 Alexandre Lacazette                  9       8           17
## 11 Heung-Min Son                       10       7           17
## 12 Marcus Rashford                      9       7           16
## 13 Raúl Jiménez                         9       7           16
## 14 Ryan Fraser                          5       9           14
## 15 Roberto Firmino                      9       5           14
## 16 Sadio Mané                          11       2           13
## 17 Aleksandar Mitrovic                 10       3           13
## 18 Gylfi Sigurdsson                     9       3           12
## 19 Christian Eriksen                    4       8           12
## 20 Richarlison de Andrade              10       2           12</code></pre></div>
<hr>
</div>
<div id="building-a-very-simple-expected-assists-xa-model" class="section level2">
<h2 class="hasAnchor">
<a href="#building-a-very-simple-expected-assists-xa-model" class="anchor"></a>Building a very simple expected assists (xA) model</h2>
<p>Suppose we are interested in trying to build an ‘expected assists’ (xA) model from the FPL data? Again, we take the first 25 gameweeks of the season as an example.</p>
<p>First we fetch the gameweek-by-gameweek details of ALL players using get_player_details, then create our model dataset by selected information that could predict assist performance, such as Key Passes and Open Play Crosses:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(fplscrapR)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)

df &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_player_details.html">get_player_details</a></span>() <span class="co"># this may take a while to load as it fetches ALL player details</span>

dfmodel &lt;-<span class="st"> </span>df %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(round %in%<span class="st"> </span><span class="dv">1</span>:<span class="dv">25</span>) %&gt;%<span class="st"> </span><span class="co"># filtering out the rounds we are interested in</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">potentialassists =</span> key_passes+open_play_crosses) %&gt;%<span class="st"> </span><span class="co"># creating a new variable that give us a potential indicator for expected assists, namely the number of key passes and open play crosses for each player</span>
<span class="st">  </span><span class="kw">select</span>(playername,assists,potentialassists) %&gt;%<span class="st"> </span><span class="co"># selecting the variables we need for our analysis</span>
<span class="st">  </span><span class="kw">group_by</span>(playername) %&gt;%<span class="st"> </span><span class="co"># transformation to group and summarize all our variables (i.e. the actual and potential assists) at the 'playername' variable level</span>
<span class="st">  </span><span class="kw">summarize_all</span>(sum) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">xA=</span>potentialassists*(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(assists)/<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(potentialassists))) <span class="co"># creating a new variable called 'xA' that attempts to predict the actual number of assists based on the relationship (from our data) between the number of assists and key passes+open play cross a player has produced</span></code></pre></div>
<p>Next we use dplyr and ggplot2 to transform and plot the data, comparing the actual FPL assists with our ‘xA’ model predictions. We also use the ‘ggrepel’ package to avoid cluttering of our plot:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggrepel)

dfmodel %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>xA,<span class="dt">y=</span>assists)) +
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.5</span>,<span class="dt">size=</span><span class="dv">2</span>) +
<span class="st">  </span><span class="kw">theme_bw</span>() +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">"Expected assists"</span>,<span class="dt">y=</span><span class="st">"Actual assists"</span>,<span class="dt">title=</span><span class="st">"Expected vs. actual assists"</span>,<span class="dt">subtitle=</span><span class="st">"Season 2018/2019 - Gameweeks 1-25"</span>, <span class="dt">caption=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"Data from fplscrapR | "</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Sys.time">Sys.Date</a></span>(),<span class="dt">sep=</span><span class="st">""</span>)) +
<span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept=</span><span class="dv">0</span>,<span class="dt">slope=</span><span class="dv">1</span>,<span class="dt">colour=</span><span class="st">"grey"</span>,<span class="dt">size=</span><span class="fl">0.5</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_text_repel</span>(<span class="dt">size=</span><span class="fl">3.75</span>,<span class="kw">aes</span>(
  <span class="dt">label=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/ifelse">ifelse</a></span>(xA&gt;<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/quantile">quantile</a></span>(xA,<span class="dt">prob=</span><span class="dv">1</span><span class="fl">-1.5</span>/<span class="dv">100</span>),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/character">as.character</a></span>(playername),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/ifelse">ifelse</a></span>(assists&gt;<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/quantile">quantile</a></span>(assists,<span class="dt">prob=</span><span class="dv">1</span><span class="fl">-1.5</span>/<span class="dv">100</span>),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/character">as.character</a></span>(playername),<span class="st">""</span>)))) +<span class="st"> </span><span class="co">#</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">12</span>),<span class="dt">breaks=</span><span class="dv">0</span>:<span class="dv">12</span>) +
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">12</span>),<span class="dt">breaks=</span><span class="dv">0</span>:<span class="dv">12</span>)</code></pre></div>
<p><img src="C:%5CUsers%5Crcc.dbp%5CAppData%5CLocal%5CTemp%5CRtmpyIobnS%5Cpreview-22d47d5d10ce.dir%5Callvignettes_files/figure-markdown_strict/unnamed-chunk-18-1.png"></p>
<p>Here we can see that there is a significant variation around our expected assists. Ryan Fraser’s ouput is, for instance, well predicted. Raheem Sterling and Leroy Sanés are not - the model firmly under-estimates their assists. Meanwhile, the assists of players like Lucas Digne and Andros Townsend are far over-estimated.</p>
<p>Finally, we test our xA model to see how it fares in explaining the variation of actual assists, using the summary function from R base:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(dfmodel,<span class="dt">formula=</span>xA ~<span class="st"> </span>assists))

## 
## Call:
## lm(formula = xA ~ assists, data = dfmodel)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.8918 -0.4299 -0.3289  0.2453  5.1987 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.42995    0.04677   9.192   &lt;2e-16 ***
## assists      0.58198    0.02221  26.203   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.9964 on 594 degrees of freedom
## Multiple R-squared:  0.5361, Adjusted R-squared:  0.5354 
## F-statistic: 686.6 on 1 and 594 DF,  p-value: &lt; 2.2e-16</code></pre></div>
<hr>
</div>
<div id="creating-an-alternative-fdr-afdr-ranking-of-opponents-by-fpl-points-allowed" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-an-alternative-fdr-afdr-ranking-of-opponents-by-fpl-points-allowed" class="anchor"></a>Creating an ‘Alternative FDR’ (aFDR) ranking of opponents by FPL points allowed</h2>
<p>Suppose now we are interested in trying to create an alternative to FPL’s “FDR” (Fixture Difficulty Ranking) based on actual FPL points allowed? Again, we take the first 25 gameweeks of the season as an example.</p>
<p>First we fetch the gameweek-by-gameweek details of ALL players using get_player_details:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(fplscrapR)

df &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_player_details.html">get_player_details</a></span>() <span class="co"># this may take a while to load as it fetches ALL player details</span></code></pre></div>
<p>Next we use dplyr and ggplot2 to transform and plot the data, ranking the teams by FPL points allowed:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)

df %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(round %in%<span class="st"> </span><span class="dv">1</span>:<span class="dv">25</span>) %&gt;%<span class="st"> </span><span class="co"># filter out the gameweeks we are interested in</span>
<span class="st">  </span><span class="kw">group_by</span>(opponent_team) %&gt;%<span class="st"> </span><span class="co"># transformation to group and summarize the total_points (scored by a given player in a given round) by the opponent ('opponent_team') variable level</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(total_points)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/reorder.factor">reorder</a></span>(opponent_team,<span class="st">`</span><span class="dt">sum(total_points)</span><span class="st">`</span>),<span class="dt">y=</span><span class="st">`</span><span class="dt">sum(total_points)</span><span class="st">`</span>,<span class="dt">fill=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(opponent_team))) +<span class="st"> </span>
<span class="st">    </span><span class="kw">geom_col</span>(<span class="dt">colour=</span><span class="st">"black"</span>) +
<span class="st">    </span><span class="kw">theme_bw</span>() +
<span class="st">    </span><span class="kw">coord_flip</span>() +
<span class="st">    </span><span class="kw">scale_x_discrete</span>(<span class="dt">labels=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"1"</span>=<span class="st">"ARS"</span>,<span class="st">"2"</span>=<span class="st">"BOU"</span>,<span class="st">"3"</span>=<span class="st">"BHA"</span>,<span class="st">"4"</span>=<span class="st">"BUR"</span>,<span class="st">"5"</span>=<span class="st">"CAR"</span>,<span class="st">"6"</span>=<span class="st">"CHE"</span>,<span class="st">"7"</span>=<span class="st">"CRY"</span>,<span class="st">"8"</span>=<span class="st">"EVE"</span>,<span class="st">"9"</span>=<span class="st">"FUL"</span>,<span class="st">"10"</span>=<span class="st">"HUD"</span>,<span class="st">"11"</span>=<span class="st">"LEI"</span>,<span class="st">"12"</span>=<span class="st">"LIV"</span>,<span class="st">"13"</span>=<span class="st">"MCI"</span>,<span class="st">"14"</span>=<span class="st">"MUN"</span>,<span class="st">"15"</span>=<span class="st">"NEW"</span>,<span class="st">"16"</span>=<span class="st">"SOU"</span>,<span class="st">"17"</span>=<span class="st">"TOT"</span>,<span class="st">"18"</span>=<span class="st">"WAT"</span>,<span class="st">"19"</span>=<span class="st">"WHU"</span>,<span class="st">"20"</span>=<span class="st">"WOL"</span>)) +<span class="st"> </span><span class="co"># here we transform the numbered team labels to the FPL short letter names</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">"Team"</span>,<span class="dt">y=</span><span class="st">"Total FPL points allowed"</span>,<span class="dt">title=</span><span class="st">"Alternative FDR ranking - by total FPL points allowed"</span>,<span class="dt">subtitle=</span><span class="st">"Season 2018/2019 - Gameweeks 1-25"</span>,<span class="dt">caption=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"Data from fplscrapR | "</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Sys.time">Sys.Date</a></span>(),<span class="dt">sep=</span><span class="st">""</span>)) +
<span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"1"</span>=<span class="st">"#EF0107"</span>,<span class="st">"2"</span>=<span class="st">"#000000"</span>,<span class="st">"3"</span>=<span class="st">"#0057B8"</span>,<span class="st">"4"</span>=<span class="st">"#6C1D45"</span>,<span class="st">"5"</span>=<span class="st">"#0070B5"</span>,<span class="st">"6"</span>=<span class="st">"#034694"</span>,<span class="st">"7"</span>=<span class="st">"#1B458F"</span>,<span class="st">"8"</span>=<span class="st">"#003399"</span>,<span class="st">"9"</span>=<span class="st">"#FFFFFF"</span>,<span class="st">"10"</span>=<span class="st">"#0E63AD"</span>,<span class="st">"11"</span>=<span class="st">"#003090"</span>,<span class="st">"12"</span>=<span class="st">"#C8102E"</span>,<span class="st">"13"</span>=<span class="st">"#6CABDD"</span>,<span class="st">"14"</span>=<span class="st">"#DA291C"</span>,<span class="st">"15"</span>=<span class="st">"#241F20"</span>,<span class="st">"16"</span>=<span class="st">"#D71920"</span>,<span class="st">"17"</span>=<span class="st">"#132257"</span>,<span class="st">"18"</span>=<span class="st">"#FBEE23"</span>,<span class="st">"19"</span>=<span class="st">"#7A263A"</span>,<span class="st">"20"</span>=<span class="st">"#FDB913"</span>),<span class="dt">guide=</span>F) <span class="co"># here we add the team-specific colours to the plot</span></code></pre></div>
<p><img src="C:%5CUsers%5Crcc.dbp%5CAppData%5CLocal%5CTemp%5CRtmpyIobnS%5Cpreview-22d47d5d10ce.dir%5Callvignettes_files/figure-markdown_strict/unnamed-chunk-22-1.png"></p>
<hr>
</div>
<div id="creating-a-simple-fixture-table" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-a-simple-fixture-table" class="anchor"></a>Creating a simple fixture table</h2>
<p>Suppose now we are interested in creating a simple overview of FPL fixtures? Again, we take the first 25 gameweeks of the season as an example.</p>
<p>First we fetch the full fixture list using get_game_list:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(fplscrapR)

gamelist &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_game_list.html">get_game_list</a></span>()</code></pre></div>
<p>FPL only lists the fixtures once, as HOME-AWAY, but we need both HOME-AWAY and AWAY-HOME to plot the full fixture table. We need to plot every fixture twice, once as a home game for the one team, and once as an away game for the other team.</p>
<p>Using R base’s rbind and dplyr’s mutate (creating new variables) we essentially just duplicate the fixture table:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)

allfixtures &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>(
  gamelist %&gt;%<span class="st"> </span><span class="kw">mutate</span>(<span class="dt">team=</span>home,<span class="dt">oppo=</span>away,<span class="dt">homeaway=</span><span class="st">"home"</span>),
  gamelist %&gt;%<span class="st"> </span><span class="kw">mutate</span>(<span class="dt">team=</span>away,<span class="dt">oppo=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/chartr">tolower</a></span>(home),<span class="dt">homeaway=</span><span class="st">"away"</span>))</code></pre></div>
<p>Next we use dplyr and ggplot2 to transform and plot the data, ranking the teams by FPL points allowed:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)

allfixtures %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(GW %in%<span class="st"> </span><span class="dv">1</span>:<span class="dv">25</span>) %&gt;%<span class="st"> </span><span class="co"># filtering for the gameweeks we are interested in</span>
<span class="st">    </span><span class="kw">ggplot</span>() +
<span class="st">      </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">x=</span>GW,<span class="dt">y=</span>team),<span class="dt">fill=</span><span class="st">"white"</span>,<span class="dt">colour=</span><span class="st">"lightgrey"</span>) +
<span class="st">      </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">x=</span>GW,<span class="dt">y=</span>team,<span class="dt">label=</span>oppo),<span class="dt">size=</span><span class="dv">2</span>) +
<span class="st">      </span><span class="kw">theme_void</span>() +
<span class="st">      </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">"bold"</span>)) +
<span class="st">      </span><span class="kw">theme</span>(<span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">margin=</span><span class="kw">margin</span>(<span class="dv">0</span>,-<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">0</span>))) +<span class="st"> </span><span class="co"># fixing the margins on the tile</span>
<span class="st">      </span><span class="kw">scale_x_continuous</span>(<span class="dt">position=</span><span class="st">"top"</span>,<span class="dt">breaks=</span><span class="dv">1</span>:<span class="dv">25</span>) +
<span class="st">      </span><span class="kw">labs</span>(<span class="dt">caption=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"Data from fplscrapR | "</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Sys.time">Sys.Date</a></span>(),<span class="dt">sep=</span><span class="st">""</span>))</code></pre></div>
<p><img src="C:%5CUsers%5Crcc.dbp%5CAppData%5CLocal%5CTemp%5CRtmpyIobnS%5Cpreview-22d47d5d10ce.dir%5Callvignettes_files/figure-markdown_strict/unnamed-chunk-26-1.png"></p>
<hr>
</div>
<div id="creating-an-alternative-fdr-afdr-fixture-table" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-an-alternative-fdr-afdr-fixture-table" class="anchor"></a>Creating an ‘Alternative FDR’ (aFDR) fixture table</h2>
<p>Suppose now we are interested in creating an FPL fixture table that ranks fixtures by the ‘Alternative FDR’ (aFDR) metric? Again, we take the first 25 gameweeks of the season as an example.</p>
<p>First we create the aFDR rankings table, by fetching the gameweek-by-gameweek details of ALL players using get_player_details, and then transforming that using dplyr:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(fplscrapR)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)

df &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_player_details.html">get_player_details</a></span>() <span class="co"># this may take a while to load as it fetches ALL player details</span>

afdrranks &lt;-<span class="st"> </span>df %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(round %in%<span class="st"> </span><span class="dv">1</span>:<span class="dv">25</span>) %&gt;%<span class="st"> </span><span class="co"># filtering for the gameweeks we are interested in.</span>
<span class="st">  </span><span class="kw">group_by</span>(opponent_team) %&gt;%<span class="st"> </span><span class="co"># transformation to group and summarize the total_points (scored by a given player in a given round) by the opponent ('opponent_team') variable level</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(total_points)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="st">`</span><span class="dt">sum(total_points)</span><span class="st">`</span>) %&gt;%<span class="st"> </span><span class="co"># ordering (arranging) by total_points allowed</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">oppo=</span><span class="kw">recode</span>(opponent_team,<span class="st">"1"</span>=<span class="st">"ARS"</span>,<span class="st">"2"</span>=<span class="st">"BOU"</span>,<span class="st">"3"</span>=<span class="st">"BHA"</span>,<span class="st">"4"</span>=<span class="st">"BUR"</span>,<span class="st">"5"</span>=<span class="st">"CAR"</span>,<span class="st">"6"</span>=<span class="st">"CHE"</span>,<span class="st">"7"</span>=<span class="st">"CRY"</span>,<span class="st">"8"</span>=<span class="st">"EVE"</span>,<span class="st">"9"</span>=<span class="st">"FUL"</span>,<span class="st">"10"</span>=<span class="st">"HUD"</span>,<span class="st">"11"</span>=<span class="st">"LEI"</span>,<span class="st">"12"</span>=<span class="st">"LIV"</span>,<span class="st">"13"</span>=<span class="st">"MCI"</span>,<span class="st">"14"</span>=<span class="st">"MUN"</span>,<span class="st">"15"</span>=<span class="st">"NEW"</span>,<span class="st">"16"</span>=<span class="st">"SOU"</span>,<span class="st">"17"</span>=<span class="st">"TOT"</span>,<span class="st">"18"</span>=<span class="st">"WAT"</span>,<span class="st">"19"</span>=<span class="st">"WHU"</span>,<span class="st">"20"</span>=<span class="st">"WOL"</span>)) <span class="co"># here we transform the numbered team labels to the FPL short letter names</span></code></pre></div>
<p>Next, we fetch the full fixture list using get_game_list:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r">gamelist &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_game_list.html">get_game_list</a></span>()</code></pre></div>
<p>FPL only lists the fixtures once, as HOME-AWAY, but we need both HOME-AWAY and AWAY-HOME to plot the full fixture table. We need to plot every fixture twice, once as a home game for the one team, and once as an away game for the other team.</p>
<p>Using R base’s rbind and dplyr’s mutate (creating new variables) we essentially just duplicate the fixture table:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r">afdrfixtures &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>(
  gamelist %&gt;%<span class="st"> </span><span class="kw">mutate</span>(<span class="dt">team=</span>home,<span class="dt">oppo=</span>away,<span class="dt">homeaway=</span><span class="st">"home"</span>),
  gamelist %&gt;%<span class="st"> </span><span class="kw">mutate</span>(<span class="dt">team=</span>away,<span class="dt">oppo=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/chartr">tolower</a></span>(home),<span class="dt">homeaway=</span><span class="st">"away"</span>))</code></pre></div>
<p>Then we need to add in the aFDR ranking for each fixture, doing so through a loop (which is decidedly not the most efficient method). For each row, we identify the data point in the afdrranks data frame that provides the aFDR ranking for each team in question:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r">for (i in <span class="dv">1</span>:<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(afdrfixtures)){
  afdrfixtures$afdr[i] &lt;-<span class="st"> </span>afdrranks$<span class="st">`</span><span class="dt">sum(total_points)</span><span class="st">`</span>[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(afdrranks$oppo==<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/chartr">toupper</a></span>(afdrfixtures$oppo[i]))]
}</code></pre></div>
<p>Next we use dplyr and ggplot2 to plot the data in a fixture table:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)

afdrfixtures %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(GW %in%<span class="st"> </span><span class="dv">1</span>:<span class="dv">25</span>) %&gt;%<span class="st"> </span><span class="co"># filtering for the gameweeks we are interested in </span>
<span class="st">  </span><span class="kw">ggplot</span>() +
<span class="st">    </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">x=</span>GW,<span class="dt">y=</span>team,<span class="dt">fill=</span>afdr),<span class="dt">colour=</span><span class="st">"lightgrey"</span>) +
<span class="st">    </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">x=</span>GW,<span class="dt">y=</span>team,<span class="dt">label=</span>oppo),<span class="dt">size=</span><span class="dv">2</span>) +
<span class="st">    </span><span class="kw">theme_void</span>() +
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">"bold"</span>)) +
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">margin=</span><span class="kw">margin</span>(<span class="dv">0</span>,-<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">0</span>))) +<span class="st"> </span><span class="co"># fixing the margins</span>
<span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">position=</span><span class="st">"top"</span>,<span class="dt">breaks=</span><span class="dv">1</span>:<span class="dv">25</span>) +
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">caption=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"Data from fplscrapR | "</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Sys.time">Sys.Date</a></span>(),<span class="dt">sep=</span><span class="st">""</span>)) +
<span class="st">    </span><span class="kw">scale_fill_gradient2</span>(<span class="dt">guide=</span>F,<span class="dt">low=</span><span class="st">"#00FF87"</span>,<span class="dt">mid=</span><span class="st">"#D6DCD8"</span>,<span class="dt">high=</span><span class="st">"#7F002D"</span>,<span class="dt">midpoint=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/median">median</a></span>(afdrfixtures$afdr)) <span class="co"># creating a gradient colour-coding that spans from lowest aFDR ranking (coloured red) to highest (coloured green)</span></code></pre></div>
<p><img src="C:%5CUsers%5Crcc.dbp%5CAppData%5CLocal%5CTemp%5CRtmpyIobnS%5Cpreview-22d47d5d10ce.dir%5Callvignettes_files/figure-markdown_strict/unnamed-chunk-31-1.png"></p>
<hr>
</div>
<div id="creating-your-own-fdr-fixture-table" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-your-own-fdr-fixture-table" class="anchor"></a>Creating your own ‘FDR’ fixture table</h2>
<p>Suppose now we are interested in creating an FPL fixture table like the FPL’s official ‘Fixture Difficulty Ranking’? Again, we take the first 25 gameweeks of the season as an example.</p>
<p>First we fetch the official FDR rankings using get_fdr:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(fplscrapR)

fdr &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_fdr.html">get_fdr</a></span>()</code></pre></div>
<p>Next we fetch the full fixture list using get_game_list:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r">gamelist &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_game_list.html">get_game_list</a></span>()</code></pre></div>
<p>FPL only lists the fixtures once, as HOME-AWAY, but we need both HOME-AWAY and AWAY-HOME to plot the full fixture table. We need to plot every fixture twice, once as a home game for the one team, and once as an away game for the other team.</p>
<p>Using R base’s rbind and dplyr’s mutate (creating new variables) we essentially just duplicate the fixture table:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)

fdrfixtures &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>(
  gamelist %&gt;%<span class="st"> </span><span class="kw">mutate</span>(<span class="dt">team=</span>home,<span class="dt">oppo=</span>away,<span class="dt">homeaway=</span><span class="st">"home"</span>),
  gamelist %&gt;%<span class="st"> </span><span class="kw">mutate</span>(<span class="dt">team=</span>away,<span class="dt">oppo=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/chartr">tolower</a></span>(home),<span class="dt">homeaway=</span><span class="st">"away"</span>))</code></pre></div>
<p>Then we need to add in the FDR ranking for each fixture, doing so through a loop (which is decidedly not the most efficient method). For each row, we identify the data point in the fdr data frame that provides the FDR ranking for each team in question, depending on whether the fixture is home or away:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r">for (i in <span class="dv">1</span>:<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(fdrfixtures)){
  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/ifelse">ifelse</a></span>(fdrfixtures$homeaway[i]==<span class="st">"home"</span>,
    fdrfixtures$fdr[i] &lt;-<span class="st"> </span>fdr$strength_overall_away[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(fdr$short_name==<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/chartr">toupper</a></span>(fdrfixtures$oppo[i]))],
    fdrfixtures$fdr[i] &lt;-<span class="st"> </span>fdr$strength_overall_home[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(fdr$short_name==<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/chartr">toupper</a></span>(fdrfixtures$oppo[i]))])
}</code></pre></div>
<p>Next we use dplyr and ggplot2 to plot the data in a fixture table:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)

fdrfixtures %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(GW %in%<span class="st"> </span><span class="dv">1</span>:<span class="dv">25</span>) %&gt;%<span class="st">  </span><span class="co"># filtering for the gameweeks we are interested in</span>
<span class="st">    </span><span class="kw">ggplot</span>() +
<span class="st">      </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">x=</span>GW,<span class="dt">y=</span>team,<span class="dt">fill=</span>fdr),<span class="dt">colour=</span><span class="st">"lightgrey"</span>) +
<span class="st">      </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">x=</span>GW,<span class="dt">y=</span>team,<span class="dt">label=</span>oppo),<span class="dt">size=</span><span class="dv">2</span>) +
<span class="st">      </span><span class="kw">theme_void</span>() +
<span class="st">      </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">"bold"</span>)) +
<span class="st">      </span><span class="kw">theme</span>(<span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">margin=</span><span class="kw">margin</span>(<span class="dv">0</span>,-<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">0</span>))) +<span class="st"> </span><span class="co"># fixing the margins</span>
<span class="st">      </span><span class="kw">scale_x_continuous</span>(<span class="dt">position=</span><span class="st">"top"</span>,<span class="dt">breaks=</span><span class="dv">1</span>:<span class="dv">25</span>) +
<span class="st">      </span><span class="kw">labs</span>(<span class="dt">caption=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"Data from fplscrapR | "</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Sys.time">Sys.Date</a></span>(),<span class="dt">sep=</span><span class="st">""</span>)) +
<span class="st">      </span><span class="kw">scale_fill_gradient2</span>(<span class="dt">guide=</span>F,<span class="dt">low=</span><span class="st">"#00FF87"</span>,<span class="dt">mid=</span><span class="st">"#D6DCD8"</span>,<span class="dt">high=</span><span class="st">"#7F002D"</span>,<span class="dt">midpoint=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/median">median</a></span>(fdrfixtures$fdr)) <span class="co"># creating a gradient colour-coding that spans from toughest FDR ranking (coloured red) to easiest (coloured green)</span></code></pre></div>
<p><img src="C:%5CUsers%5Crcc.dbp%5CAppData%5CLocal%5CTemp%5CRtmpyIobnS%5Cpreview-22d47d5d10ce.dir%5Callvignettes_files/figure-markdown_strict/unnamed-chunk-37-1.png"></p>
<hr>
</div>
<div id="finding-the-names-of-goalscorers-in-a-given-fixture" class="section level2">
<h2 class="hasAnchor">
<a href="#finding-the-names-of-goalscorers-in-a-given-fixture" class="anchor"></a>Finding the names of goalscorers in a given fixture</h2>
<p>Suppose now we are interested in finding the names of the goalscorers in a given game? Here we take the example of the fixture West Ham - Crystal Palace.</p>
<p>First we find the gameid using get_game_list and dplyr:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(fplscrapR)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)

gameid &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_game_list.html">get_game_list</a></span>() %&gt;%<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(home==<span class="st">"WHU"</span>,away==<span class="st">"CRY"</span>) %&gt;%<span class="st"> </span><span class="kw">select</span>(id)</code></pre></div>
<p>Next we fetch the game stats using get_game_stats:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_game_stats.html">get_game_stats</a></span>(<span class="dt">gameid=</span>gameid)</code></pre></div>
<p>Next we identify the goalscorers’ playerids:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r">goalscorerids &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unlist">unlist</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(df$goals_scored$a[[<span class="dv">1</span>]]$element,df$goals_scored$h[[<span class="dv">1</span>]]$element))</code></pre></div>
<p>Finally we fetch the playernames of goalscorers using get_player_name:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="reference/get_player_name.html">get_player_name</a></span>(<span class="dt">playerid=</span>goalscorerids)

##                      playername  id
## 1               Jeffrey Schlupp 141
## 2                James McArthur 147
## 3     Javier Hernández Balcázar 419
## 4 Felipe Anderson Pereira Gomes 465
## 5              Robert Snodgrass 489</code></pre></div>
<hr>
</div>
<div id="list-your-classic-mini-leagues-and-current-ranks" class="section level2">
<h2 class="hasAnchor">
<a href="#list-your-classic-mini-leagues-and-current-ranks" class="anchor"></a>List your classic mini-leagues and current ranks</h2>
<p>Suppose now we are interested in listing the classic mini-leagues of which you are a member and your current rank in those mini-leagues?</p>
<p>First we fetch the entry information using get_entry:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(fplscrapR)

df &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_entry.html">get_entry</a></span>(<span class="dt">entryid=</span><span class="dv">1076</span>)</code></pre></div>
<p>Next we select the classic league details and the relevant data columns using dplyr:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)

df$leagues$classic %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(name,entry_last_rank) <span class="co"># selecting the columns of interest here</span>

##                                    name entry_last_rank
## 1                               Man Utd            2085
## 2                               Denmark              64
## 3                            Gameweek 1           11784
## 4                               Overall           11788
## 5        Who Got The Assist? Minileague             210
## 6                twitter.com/FPLSecrets             135
## 7               The FF Community Shield             206
## 8  Official /r/FantasyPL Classic League             558
## 9              The League of Doing Bits            1991
## 10                      101 Great Goals              36
## 11                            Grøn stue               1
## 12                       AB senior 2018               1
## 13                                FPLdk               2</code></pre></div>
<hr>
</div>
<div id="visualizing-the-fpl-histories-of-entries" class="section level2">
<h2 class="hasAnchor">
<a href="#visualizing-the-fpl-histories-of-entries" class="anchor"></a>Visualizing the FPL histories of entries</h2>
<p>Suppose now we are interested in visualizing the FPL history of select entries, e.g myself (current FPL ID: 1076) and an FPL legend such as James Eggersdorff (current FPL ID: 64342)?</p>
<p>First we fetch the entry histories using get_entry_hist:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(fplscrapR)

entryhist &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_entry_hist.html">get_entry_hist</a></span>(<span class="dt">entryid=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1076</span>,<span class="dv">64342</span>))</code></pre></div>
<p>Next we plot the historical performance using dplyr and ggplot2:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)

entryhist %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>() +
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>season_name,<span class="dt">y=</span>rank,<span class="dt">group=</span>name,<span class="dt">colour=</span>name)) +
<span class="st">  </span><span class="kw">theme_bw</span>() +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">"top"</span>) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">"Season"</span>,<span class="dt">y=</span><span class="st">"Overall Rank"</span>,<span class="dt">caption=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"Data from fplscrapR | "</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Sys.time">Sys.Date</a></span>(),<span class="dt">sep=</span><span class="st">""</span>))</code></pre></div>
<p><img src="C:%5CUsers%5Crcc.dbp%5CAppData%5CLocal%5CTemp%5CRtmpyIobnS%5Cpreview-22d47d5d10ce.dir%5Callvignettes_files/figure-markdown_strict/unnamed-chunk-46-1.png"></p>
<hr>
</div>
<div id="visualizing-your-in-season-overall-rank-progress" class="section level2">
<h2 class="hasAnchor">
<a href="#visualizing-your-in-season-overall-rank-progress" class="anchor"></a>Visualizing your in-season Overall Rank progress</h2>
<p>Suppose now we are interested in visualizing the rank progression within the current season of our own FPL teams?</p>
<p>First I fetch my own entry season using get_entry_season:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(fplscrapR)

myseason &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_entry_season.html">get_entry_season</a></span>(<span class="dt">entryid=</span><span class="dv">1076</span>)</code></pre></div>
<p>Next we plot the historical performance using dplyr and ggplot2:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)

myseason %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>() +
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>event,<span class="dt">y=</span>overall_rank,<span class="dt">group=</span>name)) +
<span class="st">  </span><span class="kw">theme_bw</span>() +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">"Gameweek"</span>,<span class="dt">y=</span><span class="st">"Overall Rank"</span>,<span class="dt">caption=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"Data from fplscrapR | "</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Sys.time">Sys.Date</a></span>(),<span class="dt">sep=</span><span class="st">""</span>))</code></pre></div>
<p><img src="C:%5CUsers%5Crcc.dbp%5CAppData%5CLocal%5CTemp%5CRtmpyIobnS%5Cpreview-22d47d5d10ce.dir%5Callvignettes_files/figure-markdown_strict/unnamed-chunk-49-1.png"></p>
<hr>
</div>
<div id="listing-the-top-20-of-your-favourite-mini-league" class="section level2">
<h2 class="hasAnchor">
<a href="#listing-the-top-20-of-your-favourite-mini-league" class="anchor"></a>Listing the top 20 of your favourite mini-league</h2>
<p>Suppose now we are interested in listing the top20 teams in your favourite mini-league? Here we take the example of the current ‘Who Got the Assist? Mini-League’.</p>
<p>First we fetch the league data using get_league:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(fplscrapR)

df &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_league.html">get_league</a></span>(<span class="dt">leagueid =</span> <span class="dv">441</span>,<span class="dt">leaguetype =</span> <span class="st">"classic"</span>)</code></pre></div>
<p>Next we show the top20 ranking teams at the moment using dplyr:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)

df$standings$results %&gt;%<span class="st"> </span><span class="co"># selecting the standings and results data</span>
<span class="st">  </span><span class="kw">select</span>(entry,entry_name,player_name,rank,total) %&gt;%<span class="st"> </span><span class="co"># selecting the columns we are interested in displaying</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(rank %in%<span class="st"> </span><span class="dv">1</span>:<span class="dv">20</span>) <span class="co"># filtering for the top20 ranks</span>

##      entry         entry_name          player_name rank total
## 1   164452 Schürrle this year        Mark Sinclair    1  2004
## 2    63031   Bootstrap Theory           Liam Berry    2  2003
## 3   925417           Mendygos         Salva Ibarra    3  1999
## 4   902198    Bombers Wonders          James Wells    4  1991
## 5  1961786         NederLaget  Sebastian Berentsen    5  1980
## 6  1422278        ADIDA Oscar          Nate Thomas    6  1972
## 7   573693    @SkyPlayerInFPL           Paul Jones    7  1967
## 8  2350048             Owl FC          Alex Suarez    8  1965
## 9  1626971        Snoop N'Gog         George White    9  1960
## 10   70299   McWigan Athletic     McWigan Athletic   10  1960
## 11  100095   Dunk-King Donuts      Henry Wakefield   11  1959
## 12  111850    Keita Mooy Hart      Ashley Humphrey   12  1958
## 13  295552   The Pep Roulette Clas Lindberg Odhner   13  1956
## 14  398698       Sarrivederci         Sean Francis   14  1956
## 15 1112407      Piotrcovianka     Michal Sztajnert   15  1956
## 16  223489       Fabios flops        Stephen Ollis   16  1950
## 17  163818         SquadGoals        Viraj Bhayani   17  1949
## 18 2645314  Expected Toulouse      Chris Macartney   18  1946
## 19  421554      Hakuna Morata           Tommy Mroz   19  1945
## 20 1491075       Serenity Now      Joakim Ahlström   20  1945</code></pre></div>
<hr>
</div>
<div id="finding-the-most-owned-players-amongst-the-top-20-teams-of-your-favourite-mini-league" class="section level2">
<h2 class="hasAnchor">
<a href="#finding-the-most-owned-players-amongst-the-top-20-teams-of-your-favourite-mini-league" class="anchor"></a>Finding the most owned players amongst the top 20 teams of your favourite mini-league</h2>
<p>Suppose now we are interested in finding the most owned players in the top20 teams in your favourite mini-league? Here we take the example of the current ‘Who Got the Assist? Mini-League’.</p>
<p>First we fetch the league data using get_league:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(fplscrapR)

df &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_league.html">get_league</a></span>(<span class="dt">leagueid =</span> <span class="dv">441</span>,<span class="dt">leaguetype =</span> <span class="st">"classic"</span>)</code></pre></div>
<p>Next we save in a new data frame the entry ids’ of the top20 ranking teams at the moment, using dplyr:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyr)

top20entries &lt;-<span class="st"> </span>df$standings$results %&gt;%<span class="st"> </span><span class="co"># selecting the standings and results data</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(rank %in%<span class="st"> </span><span class="dv">1</span>:<span class="dv">20</span>) %&gt;%<span class="st">  </span><span class="co"># filtering for the top20 ranks</span>
<span class="st">  </span><span class="kw">select</span>(entry) <span class="co"># selecting only the entry ids</span></code></pre></div>
<p>Now we want to know the most selected players by these teams in a given gameweek, say gameweek 31. So we set the gameweek number and collect the players picks by each of the top20 entries using get_entry_picks. We do so through a loop (which is decidedly not the most efficient method), binding the picks together in a new data frame called ‘top20picks’:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r">gameweek &lt;-<span class="st"> </span><span class="dv">31</span>

top20picks &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>()

for (i in <span class="dv">1</span>:<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(top20entries)){
  picks &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_entry_picks.html">get_entry_picks</a></span>(<span class="dt">entryid=</span>top20entries[i,],<span class="dt">gw=</span>gameweek)
  top20picks &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>(top20picks,picks$picks)
}</code></pre></div>
<p>Finally we list the top20 most owned players amongst the top20 managers in the WGTA Mini-League using dplyr:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r">top20picks %&gt;%<span class="st"> </span><span class="co"># working with our newly created data.frame</span>
<span class="st">  </span><span class="kw">group_by</span>(element) %&gt;%<span class="st"> </span><span class="co"># transformation to group and summarize the count (number of times a given player was selected) at the element (the player) variable level</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="kw">n</span>()) %&gt;%
<span class="st">  </span><span class="kw">arrange</span>(-<span class="st">`</span><span class="dt">n()</span><span class="st">`</span>) %&gt;%<span class="st"> </span><span class="co"># arranging by most selected</span>
<span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span>:<span class="dv">20</span>) %&gt;%<span class="st"> </span><span class="co"># slicing so we just see the top20 selected players</span>
<span class="st">  </span><span class="kw">arrange</span>(element) %&gt;%<span class="st"> </span><span class="co"># arranging by element id in order to allow us to mutate (create a new variable) the element ids into player names </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">name=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">lapply</a></span>(element,get_player_name)) %&gt;%<span class="st"> </span><span class="co"># adding the playername data</span>
<span class="st">  </span>tidyr::<span class="kw">unnest</span>(name) %&gt;%<span class="st"> </span><span class="co"># unnesting the playername data via tidyr</span>
<span class="st">  </span><span class="kw">select</span>(playername,<span class="st">`</span><span class="dt">n()</span><span class="st">`</span>) %&gt;%<span class="st"> </span><span class="co"># selecting the variables of interest for our final list</span>
<span class="st">  </span><span class="kw">arrange</span>(-<span class="st">`</span><span class="dt">n()</span><span class="st">`</span>) <span class="co"># arranging by most selected again</span>

## # A tibble: 20 x 2
##    playername                       `n()`
##    &lt;chr&gt;                            &lt;int&gt;
##  1 Andrew Robertson                    20
##  2 Mohamed Salah                       20
##  3 Lukasz Fabianski                    18
##  4 Eden Hazard                         17
##  5 Jamie Vardy                         14
##  6 Callum Wilson                       13
##  7 Felipe Anderson Pereira Gomes       12
##  8 David Luiz Moreira Marinho          11
##  9 Paul Pogba                          11
## 10 Ricardo Domingos Barbosa Pereira    10
## 11 Sadio Mané                          10
## 12 Aaron Wan-Bissaka                    8
## 13 Trent Alexander-Arnold               8
## 14 Ryan Fraser                          7
## 15 Artur Boruc                          6
## 16 Matt Doherty                         6
## 17 Raúl Jiménez                         6
## 18 David Brooks                         5
## 19 James Maddison                       5
## 20 Jan Bednarek                         5</code></pre></div>
<hr>
</div>
<div id="comparing-total-team-bps-scores-for-a-given-game" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-total-team-bps-scores-for-a-given-game" class="anchor"></a>Comparing total team BPS scores for a given game</h2>
<p>Suppose now we are interested in comparing the total BPS scores for each team in a given game? Here we take the example of Manchester United - Leicester from round 1, game id 6.</p>
<p>First we fetch the game stats using get_game_stats:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(fplscrapR)

df &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_game_stats.html">get_game_stats</a></span>(<span class="dt">gameid=</span><span class="dv">6</span>)</code></pre></div>
<p>Next we structure a coherent data frame of the two teams’ total BPS points, using R base’s rbind and dplyr:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)

<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>( <span class="co"># combining the two objects containing the home and away team's BPS points</span>
  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(df$bps$a[[<span class="dv">10</span>]],<span class="dt">team=</span><span class="st">"away"</span>),
  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(df$bps$h[[<span class="dv">10</span>]],<span class="dt">team=</span><span class="st">"home"</span>)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(team) %&gt;%<span class="st"> </span><span class="co"># transformation to group and summarize the value (bps points scored by a given player in the game) at the team variable level</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(value))

## # A tibble: 2 x 2
##   team  `sum(value)`
##   &lt;fct&gt;        &lt;int&gt;
## 1 away           173
## 2 home           203</code></pre></div>
<hr>
</div>
<div id="average-and-top-entry-scores-for-the-first-25-gameweeks" class="section level2">
<h2 class="hasAnchor">
<a href="#average-and-top-entry-scores-for-the-first-25-gameweeks" class="anchor"></a>Average and top entry scores for the first 25 gameweeks</h2>
<p>Suppose we are interested in tracking the average and top FPL scores by gameweek?</p>
<p>get_round_info(1:25)</p>
<p>First we fetch the round information for a selection of gameweeks, say 1-25, using the get_round_info function:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(fplscrapR)

df &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_round_info.html">get_round_info</a></span>(<span class="dv">1</span>:<span class="dv">25</span>)</code></pre></div>
<p>Next we use dplyr, tidyr and ggplot2 to transform and plot the data, showing the average and top entry progression by gameweek:</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyr)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)

df %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(id,average_entry_score,highest_score) %&gt;%<span class="st"> </span><span class="co"># selecting the relevant columns</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="st">"var"</span>,<span class="st">"value"</span>,-id) %&gt;%<span class="st"> </span><span class="co"># transforming from wide to long format for ggplot</span>
<span class="st">  </span><span class="kw">ggplot</span>() +<span class="st"> </span><span class="co"># plotting using ggplot2</span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>id,<span class="dt">y=</span>value,<span class="dt">colour=</span>var),<span class="dt">size=</span><span class="dv">1</span>) +
<span class="st">    </span><span class="kw">theme_bw</span>() +
<span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="dv">1</span>:<span class="dv">25</span>) +
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">"Gameweek"</span>,<span class="dt">y=</span><span class="st">"Score"</span>,<span class="dt">title=</span><span class="st">"Average and top FPL entry scores by gameweek"</span>,<span class="dt">caption=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"Data from fplscrapR | "</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Sys.time">Sys.Date</a></span>(),<span class="dt">sep=</span><span class="st">""</span>))</code></pre></div>
<p><img src="C:%5CUsers%5Crcc.dbp%5CAppData%5CLocal%5CTemp%5CRtmpyIobnS%5Cpreview-22d47d5d10ce.dir%5Callvignettes_files/figure-markdown_strict/unnamed-chunk-62-1.png"></p>
</div>


  </div>

</div>


      <footer>
      <div class="copyright">
  <p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9000.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

